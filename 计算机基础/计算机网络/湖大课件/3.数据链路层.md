## 1.数据链路层概述

`链路(Link)`就是从一个结点到相邻节点的一段物理线路，而中间没有任何其他的交换结点。

`数据链路(Data Link)`是指把实现通信协议的硬件和软件加到链路上，就构成了数据链路。

数据链路层以`帧`为单位传输和处理数据，帧传输过程中如果出现了`误码`，接收方主机可以通过帧尾检错码来发现数据出错。

检错码是发送方在发送数据之前，基于待发送的数据和检错算法计算出来的，之后会将其封装在帧尾。

接收方接收到有错误的帧后，会将其丢弃。之后是否有动作，取决于数据链路层向上层提供的是可靠传输还是非可靠传输：

- `可靠传输`，就继续采取其他措施，来确保接收方主机还可以重新收到被丢弃的这个帧的正确副本。需要注意的是，尽管误码是不能完全避免的，但若能实现发送方发送什么，接收方就能接收什么，就称为可靠传输。
- `非可靠传输`，没有后续动作。

## 2.三个重要问题

### 2.1封装成帧

物理层会为数据链路层封装的帧添加上前导码，以太网还规定了帧间间隔为 96比特数据的发送时间，因此，MAC帧（数据链路层封装的帧）并不需要帧结束定界符。当然了，帧间间隔也还有其他作用。

> ppt中的flag指的是帧定界标识符。为了便于理解，ppt只画出了帧定界标识符，然后讨论网络层交付的数据中，恰好也有一个帧定界标识符的情况。
>
> 这种情况下，就需要数据链路层采取其他措施来保证透明传输，例如收到消息之后，先扫描一下消息，在消息本身内的帧定界符前面插入转义符号。不过这种方式又不能避免消息本身有转义字符的情况，俄罗斯套娃了属于是。
>
> 这里再从另外一个维度理解下透明传输：
>
> 如果数据链路层不支持上层传输帧定界标识符，那就说明数据链路层对上层交付的数据是有限制的，那就不是透明传输了。

面向比特的物理链路，可以使用**0比特填充**的方法实现透明传输。

为了提高帧的传输效率，应当使帧的数据部分的长度尽可能大些，因为仅从数据链路层来看，帧的数据部分才是真正要传输的数据，帧头和帧尾是为了实现数据链路层功能而额外添加的。

### 2.2差错检测

ppt给出的是点对点协议PPP的帧格式，其帧尾中包含了一个长度为两字节的帧检测序列FCS字段。作用也是让接收方的数据链路层检查帧在传输过程中是否产生了误码。

奇偶校验，漏检率较高，不常用。

循环冗余校验CRC，考试重点！

### 2.3可靠传输

#### 2.3.1可靠传输的基本概念

#### 2.3.2停止-等待协议

发送方和接收方通过互联网传输，而不是基于点对点的信道传输。

发送方每发送完一个数据分组后，并不能立刻将该数据分组从缓存中删除，只有在收到该数据分组的确认分组后，才能将其从缓存中删除。

简而言之，发送方在发送完一个数据分组后，就停止发送下一个分组，转而等待接收方的确认或否认分组。

但是数据分组丢失的情况，虽然在点对点信道传输中不常见，但是在多设备互连的互联网中还是很常见的。

确认迟到的情况：

对于数据链路层的点对点信道，往返时间比较固定，不会出现确认迟到的情况。因此，如果只在数据链路层实现停止-等待协议，可以不用给确认分组编号。

停止等待协议的信道利用率很低，如果出现超时重传，则信道利用率更低。

像停止等待协议这种通过确认和重传机制实现的可靠传输协议，常称为自动请求重传协议ARQ，意思是重传的请求是自动进行的。因为不需要接收方显示的请求发送方重传某个出错的分组。

#### 2.3.3回退N帧协议GBN

该协议在流水线传输的基础上，利用发送窗口来限制发送方可连续发送数据分组的个数。

#### 2.3.4选择重传协议SR

该协议是对回退N帧协议的改进。

## 3.点对点协议PPP

在1999年公布的以太网上运行的PPP协议，即PPP over Ethernet，简称PPPoE，它使得ISP可以通过DSL、电路调制解调器、以太网等宽带接入技术，以以太网接口的形式为用户提供接入服务。

为了支持不同的网络层协议，PPP协议包含了一套网络控制协议NCPs，其中的每一个协议支持不同的网络层协议。例如TCP/IP中的IP等。链路控制协议LCP用于建立、配置以及测试数据链路的连接。

PPP协议能够在多种类型的点对点链路上运行，例如面向字节的异步链路，面向比特的同步链路等。

## 4.媒体接入控制

### 4.1基本概念

### 4.2静态划分信道

频分复用FDM

时分复用TDM

波分复用WDM

码分复用CDM

### 4.3媒体接入控制-动态接入控制-随机接入

多址接入

n -> tao  m -> deta 
n - m m m/2 n - m +m/2 = n -m/2 

## 5. MAC地址、IP地址、ARP协议

全球管理多播地址：例如交换机生成树协议所需要的多播地址

## 6.集线器和交换机的区别

集线器在物理层拓展以太网，交换机在数据链路层扩展以太网。

## 7.以太网交换机自学习和转发帧的流程

目前市面上也有包含网络层部分功能的交换机，称为三层交换机。

图中给出的是两台相互连接的以太网交换机，并且各自连接了三台主机。

## 8.以太网交换机的生成树协议STP

## 9.虚拟局域网VLAN技术

### 9.1概述

### 9.2实现机制

虚拟局域网VLAN技术，是由交换机来实现的。需要交换机具备以下两种功能：

- 能够处理带有VLAN标记的帧（即IEEE 802.1Q帧）；
- 交换机的各端口可以支持不同的端口类型。







